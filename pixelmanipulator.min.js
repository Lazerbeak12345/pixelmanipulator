!function(a){"use strict";function o(o,e,t){void 0===a.window&&console.warn("This enviroment has not been tested, and is officially not supported.\nGood luck.");var m={licence:"PixelManipulator v1.66.151 (beta-proposed) Copyright (C) 2018  Nathan Fritzler\nThis program comes with ABSOLUTELY NO WARRANTY\nThis is free software, and you are welcome to redistribute it\nunder certain conditions, as according to the GNU GENERAL PUBLIC LICENSE.",loopint:0,zoomX:0,zoomY:0,row:0,elementTypeMap:{blank:{color:[0,0,0,255]}},mode:"paused",zoomScaleFactor:20,zoomctxStrokeStyle:"gray",defaultElm:"blank",onIterate:function(){},onAfterIterate:function(){},presentElements:[],__TEMPLATES__:{__LIFE__:{__INDEX__:function(o,e){if(e.pattern.search(/B\d{0,9}\/S\d{0,9}/gi)<=-1)return[];var t=e.pattern.split(/\/*[a-z]/gi);return e.loop=void 0===e.loop||e.loop,console.log("Life Pattern found: ",o,e),[m.__TEMPLATES__.__LIFE__.__LIVE__(t[2],e.loop,o),m.__TEMPLATES__.__LIFE__.__DEAD__(t[1],e.loop,o)]},__LIVE__:function(e,t,a){return function(o){e.search(o.mooreNearbyCounter(a,t))<=-1&&m.setPixel(o.x,o.y,m.defaultElm)}},__DEAD__:function(e,t,a){return function(o){-1<e.search(o.mooreNearbyCounter(a,t))&&m.setPixel(o.x,o.y,a)}}},__WOLFRAM__:{__INDEX__:function(o,e){if(e.pattern.search(/Rule \d*/gi)<=-1)return[];var t=(e.pattern.split(/Rule /gi)[1]-0).toString(2).padStart(8,"0");return e.loop=void 0!==e.loop&&e.loop,console.log("Wolfram pattern found: ",o,e),[void 0,m.__TEMPLATES__.__WOLFRAM__.__DEAD__(o,t,e.loop)]},__DEAD__:function(t,a,n){return function(o){if(o.y===m.row)for(var e=0;e<8;e++)if("1"==a[e]&&o.wolframNearby(o.x,o.y,t,(7-e).toString(2).padStart(3,"0"),n))return void m.setPixel(o.x,o.y,t,n)}}}},randomlyFill:function(o,e){o=o||15;for(var t=0;t<m.canvas.width;t++)for(var a=0;a<m.canvas.height;a++)100*Math.random()<o&&m.setPixel(t,a,e)},addMultipleElements:function(o){for(var e in o)m.addElement(e,o[e])},addElement:function(o,e){for(arguments.length<2&&(e=o,o=void 0),void 0===o&&(o=e.name),void 0===e.color&&(e.color=[255,255,255,255]);e.color.length<4;)e.color.push(255);if("string"==typeof e.pattern)for(var t in m.__TEMPLATES__){var a=m.__TEMPLATES__[t].__INDEX__(o,e);0!==a.length&&(void 0===e.liveCell&&"function"==typeof a[0]&&(e.liveCell=a[0]),void 0===e.deadCell&&"function"==typeof a[1]&&(e.deadCell=a[1]))}m.elementTypeMap[o]=e},WhatIs:function(o){var n=m.ConfirmElm(o);return function(o,e,t){for(var a=0;a<m.presentElements.length;a++)if(n(o,e,m.presentElements[a],t))return m.presentElements[a]}},play:function(o){void 0!==o&&m.reset(o),m.mode="playing",m.loopint=setInterval(m.iterate,1)},reset:function(o){m.pause(),m.canvas.width=o.canvasW||m.canvas.width,m.canvas.height=o.canvasH||m.canvas.height,void 0!==m.zoomelm.height&&(m.zoomelm.width=(o.zoomW||m.zoomelm.width/m.zoomScaleFactor)*m.zoomScaleFactor,m.zoomelm.height=(o.zoomH||m.zoomelm.height/m.zoomScaleFactor)*m.zoomScaleFactor),m.updateData();for(var e=0;e<m.canvas.width;e++)for(var t=0;t<m.canvas.height;t++)m.setPixel(e,t,m.defaultElm);m.update(),m.ctx.putImageData(m.imageData,0,0),m.row=0},pause:function(){m.mode="paused",clearInterval(m.loopint)},zoom:function(o){if(void 0!==m.zoomelm.height){void 0===o&&(o={}),void 0===o.x&&(o.x=m.zoomX),void 0===o.y&&(o.x=m.zoomY),0<=o.x&&0<=o.y&&(m.zoomX=o.x,m.zoomY=o.y),m.canvas.height<2&&(m.canvas.height=400),m.canvas.width<2&&(m.canvas.width=400),m.zoomctx.clearRect(0,0,m.zoomelm.width,m.zoomelm.height),m.zoomctx.drawImage(m.canvas,m.zoomX-Math.floor(m.zoomScaleFactor/2),m.zoomY-Math.floor(m.zoomScaleFactor/2),Math.floor(m.zoomelm.width/m.zoomScaleFactor),Math.floor(m.zoomelm.height/m.zoomScaleFactor),0,0,m.zoomelm.width,m.zoomelm.height),m.zoomctx.beginPath();for(var e=1;e<m.zoomelm.width/m.zoomScaleFactor;e++)m.zoomctx.moveTo(e*m.zoomScaleFactor,0),m.zoomctx.lineTo(e*m.zoomScaleFactor,m.zoomelm.height);for(e=1;e<m.zoomelm.height/m.zoomScaleFactor;e++)m.zoomctx.moveTo(0,e*m.zoomScaleFactor),m.zoomctx.lineTo(m.zoomelm.width,e*m.zoomScaleFactor);m.zoomctx.stroke()}},GetPixel:function(a){return function(o,e,t){if(t=void 0===t||t){for(;o<0;)o=m.canvas.width+o;for(;e<0;)e=m.canvas.height+e;for(;o>=m.canvas.width;)o-=m.canvas.width;for(;e>=m.canvas.height;)e-=m.canvas.height}else if(o<0||o>=m.canvas.width||e<0||o>=m.canvas.height)return"Blocks";return a.slice(4*(m.canvas.width*e+o),4*(m.canvas.width*e+o)+4)}},update:function(){m.ctx.putImageData(m.imageData,0,0),void 0!==m.zoomelm&&m.zoom()},ConfirmElm:function(r){return function(o,e,t,a){var n=r(o,e,a),i=m.elementTypeMap[t].color;return n[0]==(i[0]||0)&&n[1]==(i[1]||0)&&n[2]==(i[2]||0)&&n[3]==(i[3]||255)}},MooreNearbyCounter:function(t,a,o){var n=m.ConfirmElm(o);return function(o,e){return n(t-1,a-1,o,e)+n(t-1,a,o,e)+n(t-1,a+1,o,e)+n(t,a-1,o,e)+n(t,a+1,o,e)+n(t+1,a-1,o,e)+n(t+1,a,o,e)+n(t+1,a+1,o,e)}},WolframNearby:function(o){var r=m.ConfirmElm(o);return function(o,e,t,a,n){var i=[r(o-1,e-1,t,n=void 0!==n&&n),r(o,e-1,t,n),r(o+1,e-1,t,n)];return i[0]==a[0]&&i[1]==a[1]&&i[2]==a[2]}},setPixel:function(o,e,t,a){if(o=Math.floor(o).toString()-0,e=Math.floor(e).toString()-0,a=void 0===a||a,"string"==typeof t&&(m.presentElements.includes(t)||m.presentElements.push(t),t=m.elementTypeMap[t].color),a){for(;o<0;)o=m.canvas.width+o;for(;e<0;)e=m.canvas.height+e;for(;o>=m.canvas.width;)o-=m.canvas.width;for(;e>=m.canvas.height;)e-=m.canvas.height}else if(o<0||o>=m.canvas.width||e<0||o>=m.canvas.height)return;for(var n=0;n<4;n++)m.imageData.data[4*(m.canvas.width*e+o)+n]=t[n]},iterate:function(){m.onIterate();for(var o=[],e=0;e<m.imageData.data.length;e++)o[e]=m.imageData.data[e]-0;var t=m.GetPixel(o),a=function(o){"function"==typeof m.elementTypeMap[o].deadCell&&m.elementTypeMap[o].deadCell(r)};m.pixelCounts={};for(var n=0;n<m.canvas.width;n++)for(var i=0;i<m.canvas.height;i++){var r={x:n,y:i,getOldPixel:t,confirmOldElm:m.ConfirmElm(t),mooreNearbyCounter:m.MooreNearbyCounter(n,i,t),wolframNearby:m.WolframNearby(t)};if(m.confirmElm(n,i,"blank"))m.presentElements.forEach(a);else{var l=m.whatIs(n,i);"function"==typeof m.elementTypeMap[l].liveCell&&m.elementTypeMap[l].liveCell(r),void 0===m.pixelCounts[l]?m.pixelCounts[l]=1:m.pixelCounts[l]++}}m.row++,m.row>m.canvas.height&&(m.row=0),m.update(),m.onAfterIterate()},updateData:function(){m.imageData=m.ctx.getImageData(0,0,m.canvas.width,m.canvas.height),m.ctx.imageSmoothingEnabled=!1,m.ctx.mozImageSmoothingEnabled=!1,m.ctx.webkitImageSmoothingEnabled=!1,m.ctx.msImageSmoothingEnabled=!1,void 0!==m.zoomelm.height&&(m.zoomctx.imageSmoothingEnabled=!1,m.zoomctx.mozImageSmoothingEnabled=!1,m.zoomctx.webkitImageSmoothingEnabled=!1,m.zoomctx.msImageSmoothingEnabled=!1,m.zoomctx.strokeStyle=m.zoomctxStrokeStyle),m.getPixel=m.GetPixel(m.imageData.data),m.confirmElm=m.ConfirmElm(m.getPixel),m.whatIs=m.WhatIs(m.getPixel)},canvasPrep:function(o){m.canvas=o.canvas,m.ctx=m.canvas.getContext("2d"),void 0!==o.zoom&&(m.zoomelm=o.zoom,m.zoomctx=m.zoomelm.getContext("2d")),m.updateData(),void 0!==o.zoom&&m.zoom({x:Math.floor(m.canvas.width/2)-Math.floor(m.zoomelm.width/2)*m.zoomScaleFactor,y:Math.floor(m.zoomelm.height/2)-Math.floor(m.zoomelm.height/2)*m.zoomScaleFactor})}};if(console.log(m.licence),void 0===t)return m;t.exports=m}void 0===a.require&&void 0===a.module?a.p=a.pixelManipulator=o():void 0!==a.define&&void 0===a.module?a.define(o):o(a.require,a.exports,a.module)}(this);