window.p=window.pixelManipulator=Object.create({getPixel:function(){},confirmElm:function(){},whatIs:function(){},loopint:0,imageData:{},zoomX:0,zoomY:0,row:0,elementTypeMap:{blank:{color:[0,0,0,255]}},mode:"paused",zoomScaleFactor:20,ctx:{},canvas:{},zoomelm:{},zoomctx:{},zoomctxStrokeStyle:"gray",defaultElm:"blank",onZoomClick:function(o,i){return window.pixelManipulator.defaultElm},onIterate:function(){},onAfterIterate:function(){},pixelCounts:{}},{licence:{value:"pixelmanipulator.js v1.65.145 (beta-proposed) Copyright (C) 2018  Nathan Fritzler\nThis program comes with ABSOLUTELY NO WARRANTY\nThis is free software, and you are welcome to redistribute it\nunder certain conditions, as according to the GNU GENERAL PUBLIC LICENSE."},__LIFE_TEMPLATES__:{value:{__LIVE__:function(a,n,l){return function(o){var i=o.mooreNearbyCounter(l,n);a.search(i)<=-1&&window.pixelManipulator.setPixel(o.x,o.y,window.pixelManipulator.defaultElm)}},__DEAD__:function(a,n,l){return function(o){var i=o.mooreNearbyCounter(l,n);-1<a.search(i)&&p.setPixel(o.x,o.y,l)}}}},__WOLFRAM_TEMPLATE__:{value:function(n,l,e){return function(o){if(o.y===window.pixelManipulator.row){for(var i=!1,a=0;a<8;a++)"1"==l[a]&&o.wolframNearby(n,(7-a).toString(2).padStart(3,"0"),e)&&(i=!0);i&&window.pixelManipulator.setPixel(o.x,o.y,n)}}}},addMultipleElements:{value:function(o){for(var i in o)window.pixelManipulator.addElement(i,o[i])}},addElement:{value:function(o,i){for(void 0===o&&(o=i.name),void 0===i.color&&(i.color=[255,255,255,255]);i.color.length<4;)i.color.push(255);if("string"==typeof i.pattern)if(-1<i.pattern.search(/B\d{0,9}\/S\d{0,9}/gi)){var a=i.pattern.split(/\/*[a-z]/gi),n=a[1],l=a[2];void 0===i.liveCell&&(i.liveCell=window.pixelManipulator.__LIFE_TEMPLATES__.__LIVE__(l,i.loop,o)),void 0===i.deadCell&&(i.deadCell=window.pixelManipulator.__LIFE_TEMPLATES__.__DEAD__(n,i.loop,o)),console.log("life pattern found: ",o,i)}else if(-1<i.pattern.search(/Rule \d*/gi)){var e=(i.pattern.split(/Rule /gi)[1]-0).toString(2).padStart(8,"0");void 0===i.deadCell&&(i.deadCell=window.pixelManipulator.__WOLFRAM_TEMPLATE__(o,e,i.loop)),console.log("wolfram pattern found: ",o,i)}window.pixelManipulator.elementTypeMap[o]=i}},WhatIs:{value:function(o){var l=window.pixelManipulator.ConfirmElm(o);return function(o,i,a){for(var n in window.pixelManipulator.elementTypeMap)if(l(o,i,n,a))return n}}},setCanvasSizes:{value:function(o){window.pixelManipulator.canvas.width=o.canvasW||window.pixelManipulator.canvas.width,window.pixelManipulator.canvas.height=o.canvasH||window.pixelManipulator.canvas.height,window.pixelManipulator.zoomelm.width=(o.zoomW||window.pixelManipulator.zoomelm.width/window.pixelManipulator.zoomScaleFactor)*window.pixelManipulator.zoomScaleFactor,window.pixelManipulator.zoomelm.height=(o.zoomH||window.pixelManipulator.zoomelm.height/window.pixelManipulator.zoomScaleFactor)*window.pixelManipulator.zoomScaleFactor,window.pixelManipulator.updateData()}},zoomClick:{value:function(o){var i=Math.floor(o.offsetX/window.pixelManipulator.zoomScaleFactor)+Math.floor(window.pixelManipulator.zoomX-window.pixelManipulator.zoomScaleFactor/2),a=Math.floor(o.offsetY/window.pixelManipulator.zoomScaleFactor)+Math.floor(window.pixelManipulator.zoomY-window.pixelManipulator.zoomScaleFactor/2);window.pixelManipulator.setPixel(i,a,window.pixelManipulator.onZoomClick(o,{x:i,y:a})),window.pixelManipulator.update(),window.pixelManipulator.zoom({x:window.pixelManipulator.zoomX,y:window.pixelManipulator.zoomY})}},play:{value:function(o){window.pixelManipulator.mode="playing",window.pixelManipulator.loopint=setInterval(window.pixelManipulator.iterate,1)}},reset:{value:function(o){clearInterval(window.pixelManipulator.loopint),window.pixelManipulator.setCanvasSizes(o);for(var i=0;i<window.pixelManipulator.canvas.width;i++)for(var a=0;a<window.pixelManipulator.canvas.height;a++)window.pixelManipulator.setPixel(i,a,window.pixelManipulator.defaultElm);window.pixelManipulator.update(),window.pixelManipulator.ctx.putImageData(window.pixelManipulator.imageData,0,0),window.pixelManipulator.row=0}},pause:{value:function(){window.pixelManipulator.mode="paused",clearInterval(window.pixelManipulator.loopint)}},zoom:{value:function(o){0<=o.x&&0<=o.y&&(window.pixelManipulator.zoomX=o.x,window.pixelManipulator.zoomY=o.y),window.pixelManipulator.canvas.height<2&&(window.pixelManipulator.canvas.height=400),window.pixelManipulator.canvas.width<2&&(window.pixelManipulator.canvas.width=400),window.pixelManipulator.zoomctx.clearRect(0,0,window.pixelManipulator.zoomelm.width,window.pixelManipulator.zoomelm.height),window.pixelManipulator.zoomctx.drawImage(window.pixelManipulator.canvas,window.pixelManipulator.zoomX-Math.floor(window.pixelManipulator.zoomScaleFactor/2),window.pixelManipulator.zoomY-Math.floor(window.pixelManipulator.zoomScaleFactor/2),Math.floor(window.pixelManipulator.zoomelm.width/window.pixelManipulator.zoomScaleFactor),Math.floor(window.pixelManipulator.zoomelm.height/window.pixelManipulator.zoomScaleFactor),0,0,window.pixelManipulator.zoomelm.width,window.pixelManipulator.zoomelm.height),window.pixelManipulator.zoomctx.beginPath();for(var i=1;i<window.pixelManipulator.zoomelm.width/window.pixelManipulator.zoomScaleFactor;i++)window.pixelManipulator.zoomctx.moveTo(i*window.pixelManipulator.zoomScaleFactor,0),window.pixelManipulator.zoomctx.lineTo(i*window.pixelManipulator.zoomScaleFactor,window.pixelManipulator.zoomelm.height);for(i=1;i<window.pixelManipulator.zoomelm.height/window.pixelManipulator.zoomScaleFactor;i++)window.pixelManipulator.zoomctx.moveTo(0,i*window.pixelManipulator.zoomScaleFactor),window.pixelManipulator.zoomctx.lineTo(window.pixelManipulator.zoomelm.width,i*window.pixelManipulator.zoomScaleFactor);window.pixelManipulator.zoomctx.stroke()}},GetPixel:{value:function(n){return function(o,i,a){if(a=void 0===a||a){for(;o<0;)o=window.pixelManipulator.canvas.width+o;for(;i<0;)i=window.pixelManipulator.canvas.height+i;for(;o>=window.pixelManipulator.canvas.width;)o-=window.pixelManipulator.canvas.width;for(;i>=window.pixelManipulator.canvas.height;)i-=window.pixelManipulator.canvas.height}else if(o<0||o>=window.pixelManipulator.canvas.width||i<0||o>=window.pixelManipulator.canvas.height)return"Blocks";return n.slice(4*(window.pixelManipulator.canvas.width*i+o),4*(window.pixelManipulator.canvas.width*i+o)+4)}}},update:{value:function(){window.pixelManipulator.ctx.putImageData(window.pixelManipulator.imageData,0,0)}},ConfirmElm:{value:function(t){return function(o,i,a,n){var l=t(o,i,n),e=window.pixelManipulator.elementTypeMap[a].color;return l[0]==(e[0]||0)&&l[1]==(e[1]||0)&&l[2]==(e[2]||0)&&l[3]==(e[3]||255)}}},MooreNearbyCounter:{value:function(a,n,o){var l=window.pixelManipulator.ConfirmElm(o);return function(o,i){return l(a-1,n-1,o,i)+l(a-1,n,o,i)+l(a-1,n+1,o,i)+l(a,n-1,o,i)+l(a,n+1,o,i)+l(a+1,n-1,o,i)+l(a+1,n,o,i)+l(a+1,n+1,o,i)}}},WolframNearby:{value:function(l,e,o){var t=window.pixelManipulator.ConfirmElm(o);return function(o,i,a){var n=[t(l-1,e-1,o,a=void 0!==a&&a),t(l,e-1,o,a),t(l+1,e-1,o,a)];return n[0]==i[0]&&n[1]==i[1]&&n[2]==i[2]}}},setPixel:{value:function(o,i,a,n){var l=window.pixelManipulator.elementTypeMap[a].color;window.pixelManipulator.rawSetPixel(o,i,l,n)}},rawSetPixel:{value:function(o,i,a,n){if(o=Math.floor(o),i=Math.floor(i),n=void 0===n||n){for(;o<0;)o=window.pixelManipulator.canvas.width+o;for(;i<0;)i=window.pixelManipulator.canvas.height+i;for(;o>=window.pixelManipulator.canvas.width;)o-=window.pixelManipulator.canvas.width;for(;i>=window.pixelManipulator.canvas.height;)i-=window.pixelManipulator.canvas.height}else if(o<0||o>=window.pixelManipulator.canvas.width||i<0||o>=window.pixelManipulator.canvas.height)return;for(var l=0;l<4;l++)window.pixelManipulator.imageData.data[4*(window.pixelManipulator.canvas.width*i+o)+l]=a[l]}},iterate:{value:function(){window.pixelManipulator.onIterate();for(var o=[],i=0;i<window.pixelManipulator.imageData.data.length;i++)o[i]=window.pixelManipulator.imageData.data[i]-0;var a=window.pixelManipulator.GetPixel(o);window.pixelManipulator.pixelCounts={};for(var n=0;n<window.pixelManipulator.canvas.width;n++)for(var l=0;l<window.pixelManipulator.canvas.height;l++){var e={x:n,y:l,getOldPixel:a,confirmOldElm:window.pixelManipulator.ConfirmElm(a),mooreNearbyCounter:window.pixelManipulator.MooreNearbyCounter(n,l,a),wolframNearby:window.pixelManipulator.WolframNearby(n,l,a)};if(window.pixelManipulator.confirmElm(n,l,"blank"))for(var t in window.pixelManipulator.elementTypeMap)"function"==typeof window.pixelManipulator.elementTypeMap[t].deadCell&&window.pixelManipulator.elementTypeMap[t].deadCell(e);else{var w=window.pixelManipulator.whatIs(n,l);"function"==typeof window.pixelManipulator.elementTypeMap[w].liveCell&&window.pixelManipulator.elementTypeMap[w].liveCell(e),void 0===window.pixelManipulator.pixelCounts[w]?window.pixelManipulator.pixelCounts[w]=1:window.pixelManipulator.pixelCounts[w]++}}window.pixelManipulator.row++,window.pixelManipulator.row>window.pixelManipulator.canvas.height&&(window.pixelManipulator.row=0),window.pixelManipulator.update(),window.pixelManipulator.zoom({x:window.pixelManipulator.zoomX,y:window.pixelManipulator.zoomY}),window.pixelManipulator.onAfterIterate()}},updateData:{value:function(){window.pixelManipulator.imageData=window.pixelManipulator.ctx.getImageData(0,0,window.pixelManipulator.canvas.width,window.pixelManipulator.canvas.height),window.pixelManipulator.ctx.imageSmoothingEnabled=!1,window.pixelManipulator.ctx.mozImageSmoothingEnabled=!1,window.pixelManipulator.ctx.webkitImageSmoothingEnabled=!1,window.pixelManipulator.ctx.msImageSmoothingEnabled=!1,window.pixelManipulator.zoomctx.imageSmoothingEnabled=!1,window.pixelManipulator.zoomctx.mozImageSmoothingEnabled=!1,window.pixelManipulator.zoomctx.webkitImageSmoothingEnabled=!1,window.pixelManipulator.zoomctx.msImageSmoothingEnabled=!1,window.pixelManipulator.getPixel=window.pixelManipulator.GetPixel(window.pixelManipulator.imageData.data),window.pixelManipulator.confirmElm=window.pixelManipulator.ConfirmElm(window.pixelManipulator.getPixel),window.pixelManipulator.whatIs=window.pixelManipulator.WhatIs(window.pixelManipulator.getPixel),window.pixelManipulator.zoomctx.strokeStyle=window.pixelManipulator.zoomctxStrokeStyle}},setCanvas:{value:function(o){return window.pixelManipulator.canvas=o,window.pixelManipulator.ctx=window.pixelManipulator.canvas.getContext("2d"),window.pixelManipulator.canvas.addEventListener("click",function(o){window.pixelManipulator.zoom({x:o.offsetX,y:o.offsetY})}),window.pixelManipulator.canvas}},setZoomelm:{value:function(o){return window.pixelManipulator.zoomelm=o,window.pixelManipulator.zoomctx=window.pixelManipulator.zoomelm.getContext("2d"),window.pixelManipulator.zoomelm.addEventListener("click",window.pixelManipulator.zoomClick),window.pixelManipulator.zoomelm.addEventListener("drag",window.pixelManipulator.zoomClick),window.pixelManipulator.updateData(),window.pixelManipulator.zoom({x:Math.floor(window.pixelManipulator.canvas.width/2)-Math.floor(window.pixelManipulator.zoomelm.width/2)*window.pixelManipulator.zoomScaleFactor,y:Math.floor(window.pixelManipulator.zoomelm.height/2)-Math.floor(window.pixelManipulator.zoomelm.height/2)*window.pixelManipulator.zoomScaleFactor}),window.pixelManipulator.zoomelm}},canvasPrep:{value:function(o){window.pixelManipulator.setCanvas(o.canvas),window.pixelManipulator.setZoomelm(o.zoom)}}});