<!doctype html>
<!--
	This is the test html file intended to show what this library can do.
    Copyright (C) 2018  Nathan Fritzler

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program.  If not, see <http://www.gnu.org/licenses/>.
-->
<html>
	<head>
		<!--Declarations and types (media objs and favicons)-->
		<title>Pixel Manipulator</title>
		<meta charset="utf-8">
		<!--CSS files-->
		<style>
		body{
			background-color:grey;
		}
		#canvas{/*This is where the pixels are being renderd*/
			position:fixed;
			top:0;
			left:0;
		}
		#zoom-box{/*This is the container for the zoomed-in box that the user can interact with*/
			position:fixed;
			top:0;
			right:0;
			z-index:999;
			height:100%
			overflow: scroll;
		}
		</style>
	</head>
	<body>
		<!--Content-->
		<canvas id="canvas"></canvas><!--This is the place where the pixels are rendered-->
		<div id="zoom-box"><!--This is the container for the zoomed-in box that the user can interact with-->
			<canvas id="zoom" width="400" height="400"></canvas><br/><!--This is the zoomed-in box that the user can interact with-->
			<button id="rewind" alt="Rewind" title="Rewind">◄</button>
			<button id="play" alt="Play" title="Play" disabled>►</button><!--The play button that changes into a restart button when pressed,unless it's paused,then it's a play button again.-->
			<button id="pause" alt="Pause" title="Pause" disabled>▌▌</button><!--This pauses everything in #canvas-->
			<button id="oneFrameAtATime" onclick="p.loop();" alt="Next frame" title="Next frame" disabled>►▌</button><!--This executes the function called by setInterval in the play button once per click,iterating one frame at a time-->
			<br/>
			Width: <input id="width"/><br/>
			Height: <input id="height" /><br/>
			Zoom Width: <input id="zoomWidthElm"/><br/>
			Zoom Height: <input id="zoomHeightElm"/><br/>
			<br/>
			Normal click: 
			<select class="elmDrop" onchange="normalClick=this.value;">
				<option>Acid</option>
				<option>Blocks</option>
				<option>Conductor</option>
				<option selected="selected">Conway's Game Of Life</option>
				<option>Electricity</option>
				<option>FadingElectricity</option>
				<option>Highlife</option>
				<option>No-loop Conway's Game Of Life</option>
				<option>Rule 30</option>
				<option>Rule 90</option>
				<option>Rule 110</option>
				<option>Rule 184</option>
				<option>Water</option>
			</select>
			<br/>
			Ctrl click: 
			<select class="elmDrop" onchange="ctrlClick=this.value;">
				<option>Acid</option>
				<option selected="selected">Blocks</option>
				<option>Conductor</option>
				<option>Conway's Game Of Life</option>
				<option>Electricity</option>
				<option>FadingElectricity</option>
				<option>Highlife</option>
				<option>No-loop Conway's Game Of Life</option>
				<option>Rule 30</option>
				<option>Rule 90</option>
				<option>Rule 110</option>
				<option>Rule 184</option>
				<option>Water</option>
			</select><br/>
			Alt click: 
			<select class="elmDrop" onchange="altClick=this.value;">
				<option>Acid</option>
				<option>Blocks</option>
				<option>Conductor</option>
				<option>Conway's Game Of Life</option>
				<option>Electricity</option>
				<option>FadingElectricity</option>
				<option>Highlife</option>
				<option>No-loop Conway's Game Of Life</option>
				<option>Rule 30</option>
				<option>Rule 90</option>
				<option>Rule 110</option>
				<option>Rule 184</option>
				<option selected="selected">Water</option>
			</select><br/>
			<span style="position:absolute; right:0px; bottom:0px">v1.50.133 (beta)</span><!-- -->
		</div>
		<script src="pixelmanipulator.js"></script>
		<script>
			function ready(callback){ //the original was from https://stackoverflow.com/a/7053197 , but I added returns in order to speed up the prossess.
				// in case the document is already rendered
				if (document.readyState!='loading') {callback(); return;}
				// modern browsers
				if (document.addEventListener) {document.addEventListener('DOMContentLoaded', callback); return;}
				// IE <= 8
				document.attachEvent('onreadystatechange', function(){
					if (document.readyState=='complete') callback();
				});
			}
			ready(function() {
				var file = document.getElementById('file'),
					normalClick="Conway's Game Of Life",
					ctrlClick="Blocks",
					altClick="Water";
				canvas = p.setCanvas(document.getElementById('canvas'));
				zoomelm = p.setZoomelm(document.getElementById('zoom'));
				p.elementTypeMap={
					"Acid":[110,162,10,255],
					"Blocks":[127,127,127,255],
					"Conductor":[67,75,77,255],
					"Conway's Game Of Life":[0,255,0,255],
					"Electricity":[148,133,0,255],
					"FadingElectricity":[148,133,0,254],
					"Highlife":[0,255,128],
					"No-loop Conway's Game Of Life":[0,150,0,255],
					"Rule 30":[255,0,255,255],
					"Rule 90":[147,112,219,255],
					"Rule 110":[128,0,128,255],
					"Rule 184":[255,51,153,255],
					"Water":[23,103,167,255],
					"blank":[0,0,0,255]
				};
				document.getElementById("play").addEventListener('click',function() {
					p.play({
						canvasW:document.getElementById("width").value||100,
						canvasH:document.getElementById("height").value||100,
						zoomW:document.getElementById("zoomWidthElm").value||20,
						zoomH:document.getElementById("zoomHeightElm").value||20,
					});//pass a function in that you want called if it is becoming unpaused. Reccomended to have a function here that sets the canvas size here, due to how startup works.
					document.getElementById('play').disabled = true;
					document.getElementById('pause').disabled = false;
				});
				document.getElementById("rewind").addEventListener('click',function() {
					p.rewind({
						canvasW:document.getElementById("width").value||100,
						canvasH:document.getElementById("height").value||100,
						zoomW:document.getElementById("zoomWidthElm").value||20,
						zoomH:document.getElementById("zoomHeightElm").value||20,
					});//pass a function in that you want called if it is becoming rewinded. Reccomended to have a function here that sets the canvas size here, due to how startup works.
					document.getElementById('play').disabled = true;
					document.getElementById('oneFrameAtATime').disabled = false;
					document.getElementById('rewind').disabled = false;
					document.getElementById('pause').disabled = false;
				});
				document.getElementById("pause").addEventListener('click',function() {
					document.getElementById('pause').disabled = true;
					document.getElementById('play').disabled = false;
					p.mode="paused";
					clearInterval(p.loopint);
				});
				p.onZoomClick=function(e,theVictomPixelsNameIsTheValueOf) {
					//console.log("onZoomClick");
					var active=normalClick//The default is normalClick.
					if (e.ctrlKey) active=ctrlClick;
					else if(e.altKey) active=altClick;
					if (theVictomPixelsNameIsTheValueOf(active)) active="blank";
					console.log("zoom",active)
					return active;
				};
			});
		</script>
	</body>
</html>
